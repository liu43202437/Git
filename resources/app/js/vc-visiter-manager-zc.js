"use strict";Vue.component("visiter-zc",{template:'\n    <div>\n      <div v-for="item in peoData">\n        <div v-if="item.type === \'input\'">\n          <list-item :item="item"></list-item>\n        </div>\n        <div v-if="item.type === \'select\'">\n          <mobile-select :info="item.info" :list="item.list" :init="initData" @selectChange="selectChange($event,item)"></mobile-select>\n        </div>\n        <div v-if="item.type === \'verify\'">\n          <verify-item :item="item"></verify-item>\n        </div>\n      </div>\n      <div class="mt-30">\n        <button class="sub-btn" @click="submit">提交</button>\n      </div>\n    </div>\n  ',data:function(){return{peoData:[{type:"input",lab:"姓名",value:"",show:!1,verifyFn:function(t){return!!/^[\u4e00-\u9fa5]{2,}$/.test(t)}},{type:"input",lab:"身份证号",value:"",show:!1,verifyFn:function(t){return!!/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/.test(t)}},{type:"select",info:{lab:"地区",title:"请选择地区",id:"province"},list:CITY_CODE,selectItem:null},{type:"input",lab:"所属公司",value:"",show:!1,verifyFn:function(t){return!!t}},{type:"verify",lab:"手机号",value:"",varifyLab:"验证码",verifyVal:"",show:!1,verifyFn:function(t){return!!/^1[34578]\d{9}$/.test(t)}}],submitting:!1,errText:"信息填写有误",refuse:"0",initData:{id:"",code:""}}},created:function(){this.refuse=axiosUrlParams("refuse"),"1"===this.refuse&&this.getinfo()},methods:{getinfo:function(){var t=this;apiRequest("/app/lottery/send_lotteryinfo").then(function(e){1===e.status.succeed&&e.data&&"1"===e.data.refuse&&(t.refuse="1",t.peoData[0].value=e.data.name||"",t.peoData[1].value=e.data.id_number||"",t.peoData[3].value=e.data.company||"",t.peoData[4].value=e.data.phone||"",t.initData={id:e.data.area_id||"",code:e.data.area_code||""})}).catch(function(t){console.log(t),swal({button:"关闭",text:"信息获取失败,请联系客服"})})},selectChange:function(t,e){console.log("selected change",t),e.selectItem=t},submit:function(){var t=this;if(!this.submitting){this.submitting=!0;var e={name:"",componey:"",phone:"",id_number:"",area_id:"",area_code:"",address:"",city:"",code:""};this.bindData(this.peoData,e)?apiRequest("/app/lottery/enroll_lottery",e).then(function(t){1===t.status.succeed?swal({button:"确定",text:"信息提交成功，请您耐心等待审核！"}).then(function(){setTimeout(function(){Router.navigateWithSid("/resources/app/vc-visiter-manager-info.html",{})},1e3)}):swal({button:"关闭",text:"注册失败,"+t.status.error_desc})}).catch(function(t){console.log(t),swal({button:"关闭",text:"注册失败，请检查网络！"})}).then(function(){t.submitting=!1}):swal({button:"关闭",text:this.errText})}},bindData:function(t,e){this.errText="信息填写有误";var i=this.listItemData(t[0],e,"name"),n=this.listItemData(t[1],e,"id_number"),a=this.listItemData(t[3],e,"componey"),s=this.listItemData(t[4],e,"phone"),o=this.checkCode(t[4],e),r=this.selectItemData(t[2],e);return!!(i&&n&&a&&s&&o&&r)||(this.submitting=!1,!1)},listItemData:function(t,e,i){return t.verifyFn(t.value)?(e[i]=t.value,!0):(t.show=!0,!1)},checkCode:function(t,e){return t.verifyVal&&6===t.verifyVal.length?(e.code=t.verifyVal,!0):(this.errText="验证码位数有误",!1)},selectItemData:function(t,e){return t.selectItem?(e.area_id=t.selectItem.id,e.area_code=t.selectItem.code,e.address=t.selectItem.value,e.city=t.selectItem.secondVal,!0):(this.errText="地区选择错误",!1)}}});